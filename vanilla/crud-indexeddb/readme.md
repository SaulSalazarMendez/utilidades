# Crud Indexeddb

Usar indexeddb con operaciones CRUD.

[DEMO](https://saulsalazarmendez.github.io/ejemplos/try-coding/#N4IghgrgLg9gTiAXOa8AEBlMAvgNpgWRABoQoBLKCXGJEAYTggBM0BJAO2YFMAPb5swBGaEiABm3AMYALMEgCMANgDsADhUBmAJxLNapdoBMpKTGbkA5rUQBtEAB4LANzTlmAXgA64AA6+fAD4vDjQ0BwBbAE8AWigwIVxuQIcAemi4hKTgjjSXHJCHAGcpOHJfKDQiuClvEBkoKF8ixFTUqWYOACsigDopGhZxXDA4bn6YCNSwLrBeVNxyISL0sChuMrBFgC9uVIVegAYj1J7V9c2d8YjyDl6eoLSSsoqc4tLyyuranwamlraHW6fQGMCGIzGEymMzmCyWK2cED2Rl6Sl6CkOqUR11u9yKj1Sz0+gVEpAAAuQIr54JVfo1mq12p0ev1BsxhqNxmZobN5otlucNuQtuRdvsjicpEUVhE1kKRbtejc7lL8SAxJTqXBKsBGCxODx+IIhABfNDiOCTNAAcj+DLaEA4vgA1pYoe0mMwYrdDQJhNaANwhELiR1SCgwUKRgCicEtcAAFNwAJRoYAhMJhMwcIowJK9GiWJPJoMcE3BjjZoqVeKJMBFNAeNMZzO+Da5jj1xDN0KZvttdxoHhoEZoWsjFt9sLubvW9zWydoctl0shVIAKnXGfXaAAau3yJGh9w3Fw+AIACJCYhVE9SMARITCtDZl9gZhgN+Pw/Hkf1sdZPWvTbqkIRVpUzgHkeTYKKuHBJJUwiNmgHDcAA7mgerMAa57GgmJYVmAaFgJQQ5CL0tyUAm1rrNW1o3pBcBFIeHA3uO9Y3jGcbwARHAVruSJQtSqEcFA1EZOO3D0T2fYfvE3b4Y2JLpr2U5oGMVBwKEKlqWpwjdsIxCLrpaBtkxkbdjpJm6SM1YAHIPtws70cZ1lhJ2EROTaC6qdZJpGb5JlmR2LRoLYAC6rlhMufb+YunlQDI5ihVZanvswAAK7aRgmwWRqmqXWQhaAwEIXTIYl5BFKWblhJVfTCL01LVtReWdkU0ltcmvSJdwHAJmMRTCUUJ4eMpUXWaVXQFjA75ZeZOb4TVtUmrxtVjjIVVNdloQeIV622VADmec5AXrX2HledaPnrSay1qXFgWZjQc07UUin7TZ3CVFNFWbdVE19vVvSNYsLXWm19bWt1vX9WD8RKTJ51hFN20LQ2Tbw2A91+WtumPSZPAIdw80dgm7gFYDz3fSVZV/VVOMmcDjVE993CtTtUM3hTPUyH1A3cENkYjYjn1uajL2ZW9S1U9FeMPYuBOZhEYKiQI3ahpWEb9cmYsjjTv1NvVjOZiNUAACqUtwYJiRQzqiyZstkQWVViRDnMdTDfP9YNw2jeNT3i2VaMhchvvC9wTurSb0U3hihzy0uZ2ZusVIjOs3YAAaLk45DOAUvm564Az1kUdSWmhQQ5y4L62WXPhmPgRQKEYaARC3VdPUXtel3U95wKwiRIjElhjFEQ6jM6fUxAoncmd3JfSn3oxetm6yiWgaGbescR8FAc/WcUvhgKEi/1yA/dehQUBJEEOFGkITzHxwORuQ4viBPffoiILaCOp+fM4wPnIH1BGx84CfmCq7cgcBTziHgLKKQ5AADPoQeCiUtMefAfBfA0AgcweAN4aBoAAI5IlMhsG46wxwQKEDCWBr4OBImrBAhsYBcHkHvEgyMv80LcBEPEUSMA0B9RHLcbgn5uTCNETAcQwxxG9DSB/NyVMj4nx7kvBuK84iUFviAQIWF2BniNMIJ+J9X6H2oBY+eixAjRgbP/MRQgxibFMqMT87DFj9z/A2GAZkwDcNQg2UoLAqilTGABOsDZhxf2YFeNItjVG2IADL/j8RsAJLFf4dlMjAasN5fDQATBAXwckUxENdjeVm6wEnkGsbpNIViJp5DzvUsILT8451SPkFsHSC59gXnXcuMBK76OaTIAALHYro3A04wDSJMtpmZ36BAAErSFGJYT83BsG8FwfAd86AeBDWYb+MAo9uBbNgXJPJSilntJrmfOotxClQBiOIEBuBWCNyqEoA+88XnQDcJ4HwHymJQAAPqXR8GOKIbY6jrF4PvEAaBnAxBVkTOobVejQpRU8nwzgRRlP+Q0kYQgdnmngHUMF1YoWOSCAAMRgdWNAx1uAJISDs+54RumtOaY8oZPhAVvI+Ts75eZfkkrUg4YVwK6iHTpZ5GFUA4XcARXvGF+KQCEsWMSlFaKMU7KxTtAs9Yjr0rGYHZZZKKXwLgPKs1irI76NSSytlHLyW4G5X01yPqu412rFEJIYR1VIpiCKSwHBuxlEsA0IMlrpVCGgLAU+gqQDEUgkUGI3A5HSEqBmwWMRFixsqEIKAfF9UxAsgMThzo6jpVJjlLqQQACCgg0hJsaJGJZfS+w50kvUhwUA4DesSoEdwaQx3NLHUy8Fl1J0yFHYu115bHILpJNOxdLbwwsSKOu31qRh09uHai95VKfBtVPBQ9GUrllQGYIEYAwBsXuBNCaSdD7p0Pqfdiy6b6P0bqtUO79z6TWHTZf+w9n6gP3pJA4TtKaNHnwLVmnNkhwybzAJmotVgGhoDLRW091avF1p8NUkmO1comopkEGIHbk3dp5bBg9R6ukDq6fkbOvZo4hEJbA9hvhkKoQwgJdmhUdmzgAMQCekpmeKqt1jMAUqmMaSM1JVjzOMQs4lIzxAIdDHG/k+1lhLCAcKJogA===)

## Install
```
npm i crud-indexeddb
```


## Setup

Ejemplo de uso:

```js
import {CrudIndexeddb} from 'crud-indexeddb';

function onError(e) {
    console.log(e);
}

const tablas = {
    persona: {
        //id de la tabla
        id: 'id'
    }
};

/**
 * Version de indexedDb, se cambia con cada cambio de las tablas.
 */
const version = 1;

let db = new CrudIndexeddb();

await db.init('test', version, tablas, onError);

```

## cdn

Uso con unpkg:
```js
import {CrudIndexeddb} from 'https://unpkg.com/crud-indexeddb';
```

## Crear datos (post)

Para agregar datos a una tabla necesitamos hacer un post:
```ts
db.post(tabla: string, datos: Object, autoid: booblean): Promise<Object>;
```

donde:


| Opcion         | tipo    | Description                                                   |
| -------------- | ------  | -----------------------------------------                     |
| `tabla`        | string  | Nombre de la tabla                                            |
| `datos`        | Object  | Datos que se guardaran                                        |
| `autoid`       | boolean | Indica si se genera el id automaticamente, por defecto es true|

**Nota**:  Por defecto el id que se crea es un timestamp(Date.now).

Ejemplo guardar persona con auto id:
```js
db.post('persona',{nombre: 'Juan'}).then(response => {
    console.log('persona guardada', response);
}).catch(error => {
    console.log('ocurrio algo malo');
});
```

Crear persona con id personalizado
```js
db.post('table1',{nombre: 'Juan', id: 1}, false).then(response => {
    console.log('save something', response);
}).catch(error => {
    console.log('bad something happened');
});
```

## Leer datos

Contamos con dos opciones: get and list.

### Get 

Regresa un item que concuerda con el id dado.
```ts
db.get(tabla: string, id: any): Promise<Object>;
```
donde:
| Opcion         | tipo    | Description                              |
| -------------- | ------  | -----------------------------------------|
| `tabla`        | string  | Nombre de la tabla                       |
| `id`           | any     | Id que identificara al campo             |
Ejemplo
```js
db.get('persona', 142563652).then(response => {
    console.log('la persona', response);
}).catch(error => {
    console.log('no existe la persona');
});
```

### List
Regresa la lista de todos los items de la tabla
```ts
db.list(tabla: string): Promise<[Object]>;
```
donde:
| Opcion         | tipo    | Description                              |
| -------------- | ------  | -----------------------------------------|
| `tabla`        | string  | Nombre de la tabla                       |

```js
db.list('persona').then(response => {
    console.log('Todas las personas', response);
}).catch(error => {
    console.log('');
});
```

## Actualizar datos

Para actualizar los registro de la tabla usamos
```ts
db.put(tabla: string, datos: Object): Promise<Object>;
```
donde
| Opcion         | tipo    | Description                                                                         |
| -------------- | ------  | ------------------------------------------------------------------------------------|
| `tabla`        | string  | Nombre de la tabla                                                                  |
| `datos`        | Object    | Es un objecto que contiene los datos, debe incluir el id con el que se identifica.|

Nota: Si no existe el id, creara automaticamente el registro.
```js
db.put('persona',{id: 142563652, nombre: 'Juana'}).then(response => {
    console.log('persona actualizada', response);
});
```
 
## Delete

All items have a id, so when we delete a item use the id of item for delete it.
```ts
db.delete(tabla: string, id: any): Promise<Boolean>;
```
donde:
| Opcion         | tipo    | Description                              |
| -------------- | ------  | -----------------------------------------|
| `tabla`        | string  | Nombre de la tabla                       |
| `id`           | any     | Id que identificara al campo             |


```js
db.delete('persona', 142563652).then(response => {
    console.log('delete the item', response);
});
```


